
HIGH (MVP) - CORE GAMEPLAY OVERHAUL

=== LAYOUT REDESIGN (Duel Links Style) ===

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Enemy Portrait] [Enemy Stats]  Energy: â– â– â– â–¡â–¡  â”‚  Y: 50-100 (compact)
â”‚      (small)        (compact)         7/10     â”‚
â”‚                                                 â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚              â”‚ ðŸ‚  ENEMY â”‚  Enemy staging area   â”‚  Y: 300
â”‚              â”‚   CARD   â”‚  (face-down)          â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                   VS                            â”‚  Y: 450 (center)
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚              â”‚ ðŸ‚  YOUR  â”‚  Your staging area    â”‚  Y: 600
â”‚              â”‚   CARD   â”‚  (face-down)          â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                 â”‚
â”‚ [Your Stats]   Energy: â– â– â– â– â–¡   [Your Portrait] â”‚  Y: 750-800 (compact)
â”‚   (compact)        4/10            (small)     â”‚
â”‚                                                 â”‚
â”‚           [CONFIRM PLAY]  â† appears on select  â”‚  Y: 850
â”‚  [Hand: 5 cards spread horizontally]           â”‚  Y: 900-1100
â”‚  [Card][Card][Card][Card][Card]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Key UI Changes:**
- Enemy portrait: Left side at top
- Player portrait: Right side at bottom
- Stats: Horizontal bars next to portraits (was below)
- Energy: Top-right corner, visual dots (â– â– â– â–¡â–¡)
- Battle log: REMOVED from main view (can be toggle/overlay)
- Staging area: Central focus, larger cards
- Confirm button: Above hand (Y: 850) with high depth
- Hand: Bottom, slightly overlapping cards

**Components to Create:**
1. CompactPlayerInfo.js - Portrait + stats + energy in one component
2. StagingArea.js - Manages both face-down card slots
3. EnergyDisplay.js - Visual energy counter

**Benefits:**
âœ… More space for important info (cards, staging)
âœ… Cleaner, less cluttered
âœ… Mobile-friendly layout
âœ… Familiar to card game players

=== PHASE 1: SIMULTANEOUS CARD SYSTEM ===
âœ… Implement card selection (click = select, not play)
âœ… Card zoom/enlarge on selection with VIEW and CONFIRM buttons
âœ… Create face-down card staging area (center screen)
âœ… Lock in player card face-down
âœ… AI auto-selects card face-down
âœ… Both cards reveal simultaneously with delay
âœ… Fixed: Cards stacking/blur issue (proper cleanup)
=== PHASE 2: CARD TYPES & PRIORITY ===
âœ… Card Types (priority order):
âœ… COUNTER cards - Speed 10, can cancel opponent (Red border)
âœ… QUICK cards - Speed 7-9, fast but weak (Blue border)
âœ… NORMAL cards - Speed 4-6, balanced (Green border)
âœ… POWER cards - Speed 1-3, slow but devastating (Gold border)

âœ… Add cardType property to all cards
âœ… Add speed property to all cards
âœ… Implement priority resolution system
âœ… Update card visuals with color-coded borders
âœ… Show speed value on cards (next to energy cost)
âœ… Display energy & speed in enlarged card view

=== PHASE 3: ENERGY SYSTEM ===
âœ… Add energy counter UI (display below portrait for player stats for us and above foes stats for foe)
âœ… Start at 5 energy, +5 per turn, max 20
âœ… Add energyCost to all cards (removed color coding, using type borders instead):
    - Counter: 2 energy
    - Quick: 3-4 energy
    - Normal: 5 energy
    - Power: 6-8 energy
âœ… Disable cards if not enough energy
âœ… Gray out unplayable cards
âœ… Show energy cost on cards (white/gray, no rainbow colors)
âœ… Add PASS button (always visible, left side, allows skipping turn)
âœ… Max 4 cards in hand, no discard mechanic

=== PHASE 4: VISUAL FEEDBACK (30 min) ===
âœ… Show both cards face-down in center area
âœ… Flip animation for reveal
âœ… Highlight which card resolves first
âœ… Apply effects in priority order with delay
âœ… Show cancellation effects (if counter cancels card)
âœ… Floating stat change numbers

=== PHASE 5: IMPROVED HAND & DRAW (30 min) ===
âœ… Start with 5 cards instead of 3
âœ… Draw 2 cards per turn (instead of 1)
âœ… Deck counter UI

=== PHASE 6: ONLINE MULTIPLAYER (40-60 hours total) ===

=== Backend Setup (8-12 hours) ===
âœ… Create /server folder, install express + socket.io + cors
âœ… Set up Express server on port 3001 with CORS
âœ… Configure Socket.io connection handlers
âœ… Create matchmaking queue (FIFO array, pair when 2 players)
âœ… Create game rooms Map (roomId â†’ game state)
âœ… Server-side card validation:
    - Is it player's turn to play?
    - Has player already played this turn?
âœ… Handle disconnections (opponent wins if player leaves)
âœ… Socket event: 'selectCard' with validation
âœ… Socket event: 'bothCardsSelected' emitted when both play
âœ… Refactor server into modular structure (index.js + socketHandlers.js)
âœ… Create test-client.html for browser testing
âœ… Comprehensive server logging for card selection flow
âœ… Test and validate full card selection workflow

=== Game State Synchronization (2-4 hours) ===
[ ] Import card database to server (lCards, kiraCards from cards.js)
[ ] Server shuffles decks on game start
[ ] Server deals initial hands (5 cards each)
[ ] Server validates card is in player's hand
[ ] Server calculates stat changes from card effects
[ ] Server determines win/loss conditions
[ ] Track full game state server-side (stats, decks, hands, energy)
[ ] Emit complete game state updates to both clients
[ ] Handle turn progression and energy increments
[ ] Implement card draw (2 cards per turn)

=== Frontend Network Layer (8-12 hours) ===
[ ] Create NetworkManager.js (socket.io-client)
[ ] Connect to server, emit/listen for events
[ ] Refactor BattleScene with isMultiplayer flag
[ ] Disable AI when multiplayer mode active
[ ] Send card selection to server, wait for response
[ ] Update UI from server game state (don't calculate locally)
[ ] Show "Waiting for opponent..." UI

=== Multiplayer Lobby UI (4-6 hours) ===
[ ] Create MultiplayerLobbyScene
[ ] Username input + character selection
[ ] "Find Match" button â†’ matchmaking queue
[ ] "Searching..." animation while waiting
[ ] Connection status indicator
[ ] Handle match found â†’ transition to BattleScene

=== Google Cloud Deployment (10-15 hours) ===
[ ] Create GCP project, enable billing
[ ] Install gcloud CLI, authenticate
[ ] Write Dockerfile for Node.js server
[ ] Deploy to Cloud Run: gcloud run deploy
[ ] Set up Firestore for user stats (optional)
[ ] Configure environment variables (CORS, production URL)
[ ] Update frontend to use production server URL
[ ] Test WebSocket/long-polling on Cloud Run
[ ] Set up monitoring, logging, billing alerts

=== Testing & Bug Fixes (5-10 hours) ===
[ ] Test locally with 2 browser windows
[ ] Test production with 2 devices (phone + laptop)
[ ] Handle edge cases: refresh, timeout, spam clicks
[ ] Latency testing and optimization

**ESTIMATED TOTAL: 45-70 hours (1-2 weeks full-time, 3-4 weeks part-time)**

**Cost: $0-5/month for first few months with free tier**


PHASE 7: ADDITIONAL FEATURES (Post-MVP)

=== Music ===
Allow user to select between multiple background tracks during gameplay
[ ] Implement music selection menu
[ ] Add at least 2 background tracks

IN PROGRESS
[ ] Fix: Cards clickable during opponent turn (DONE - waiting for test)
DONE
âœ… Fix turn system - Player â†’ AI â†’ repeat
âœ… Battle log system
âœ… Side-by-side portrait layout
âœ… Character name changes (copyright-safe)
âœ… Cards blocked during opponent turn

POLISH (After Core Gameplay Works)

CARDS
[ ] Stat change floating numbers with animations
[ ] Add deck visual and pickup animation
[ ] Improve Card UI to look more like trading cards
[ ] Discard pile visualization
[ ] Prevent duplicate cards in hand
[ ] Card hover effects showing detailed info

LOG
[ ] Better formatting (bigger text, icons)
[ ] Color-code different message types
[ ] Show combo chains in log

CHARACTERS
[ ] Character passive skills (hover portrait to see)
[ ] Winning expression switch (when stats >75)
[ ] Losing expression switch (when stats <25)
[ ] Make enemy character slightly bigger
[ ] Add character skill descriptions

USER EXPERIENCE
[ ] Exit game screen/menu
[ ] Settings menu
[ ] Tutorial/help screen

ART
[ ] Better background themes
[ ] Particle effects for card plays
[ ] Screen shake for big moves

MEDIUM PRIORITY (Post-Launch Features)

AI
[ ] Improve AI intelligence for card type selection
[ ] AI energy management strategy
[ ] AI learns player patterns

CONTENT
[ ] Create 20-30 cards per character (currently 9)
[ ] Design character-specific field cards
[ ] Add card combo synergies
[ ] Card rarity system (common, rare, ultra rare)
[ ] Story mode with progression
[ ] Cutscenes between battles

CHARACTERS
[ ] Character selection screen improvements
[ ] More character choices (4+ characters)
[ ] Character unlock system
[ ] Generic stat slot system for different character types
    - Allow characters to have custom stat names (e.g., "Legal Power" vs "Evidence")
    - Cards use generic slots (slot1, slot2, etc.) that map to character-specific stats
    - Display layer translates slot names to actual stat names
    - Enables totally different character archetypes beyond Death Note theme

AUDIO
[ ] Background music
[ ] Card play sound effects
[ ] Stat change sounds
[ ] Win/lose music

GAME MODES
[ ] Ranked mode
[ ] Time limit per turn option
[ ] Best of 3 matches

LOW PRIORITY (Future Expansion)

ADVANCED FEATURES
[ ] Deck builder - custom 30-card decks
[ ] Collection system
[ ] Card unlocks/rewards
[ ] Multiple win conditions
[ ] Tournament mode

ART
[ ] Original sprite art (replace AI-generated)
[ ] Better win/lose animations
[ ] Card art for each card
[ ] Animated backgrounds

TECHNICAL
[ ] Mobile optimization
[ ] iOS/Android build with Capacitor
[ ] Save/load system
[ ] Cloud sync
ART
- sprites are cool but really I should make some original sprites
- better win animations
GAME MECHANICS
-multiplayer mode
-add deck visualizer

NOTES NOT AI GENERATED TO GENERATE
make everything that can be abstracted such as the battle log a modal that can be opened and closed